# Headers de sécurité
<IfModule mod_headers.c>
    Header set X-Frame-Options "DENY"
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    Header set Permissions-Policy "geolocation=(), microphone=(), camera=()"
    Header unset X-Powered-By
</IfModule>

# Bloquer l'accès aux fichiers sensibles
<FilesMatch "\.(env|sql|log|md|git|gitignore)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Bloquer les dossiers sensibles
RedirectMatch 403 ^/priv[eé]+/.*$
RedirectMatch 403 ^/sextape.*$

# Protection contre le hotlinking
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTP_REFERER} !^$
    RewriteCond %{HTTP_REFERER} !^https?://(www\.)?github\.io [NC]
    RewriteCond %{HTTP_REFERER} !^https?://localhost [NC]
    RewriteRule \.(jpg|jpeg|png|gif|webp)$ - [F,NC,L]
</IfModule>

# Désactiver le listing des répertoires
Options -Indexes

# Empêcher l'exécution de scripts dans uploads
<Directory "uploads">
    <FilesMatch "\.php$">
        Order Allow,Deny
        Deny from all
    </FilesMatch>
</Directory>

# Fichier .htaccess vide
